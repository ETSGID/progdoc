<body>
<script src="<%=contextPath%>/js/funciones.js"></script>
<div class="myHeader sticky">
    <p>Gestión</p>
    <%if (locals.planID && locals.planEstudios && (locals.submenu === "Grupos")) { %>
    <div class="row col-sm"  style="margin-left:0px">
        <div clas="container">
            <select id="selectPlan" onchange="cambiarPD()">
                <% for(let i=0; i < planEstudios.length; i++) { 
                    if (planEstudios[i].nombre !== null){ %>
                    <option value="<%=planEstudios[i].codigo%>" title="<%=planEstudios[i].nombreCompleto%> (<%=planEstudios[i].codigo%>)"><%=planEstudios[i].nombre%></option> 
                    <%}else {%>
                    <option value="<%=planEstudios[i].codigo%>" title="<%=planEstudios[i].nombreCompleto%> (<%=planEstudios[i].codigo%>)"><%=planEstudios[i].codigo%></option> 
                    <%}
                }%>
            </select>
        </div>
    </div>
    <%}else if(locals.submenu === "Calendario"){%>
        
        <select id="selectano" onchange="cambiarano()">

                <option value="<%=ano3%>"><%=ano3.substring(2,5)%>/<%= parseInt(ano3.substring(2,5)) + 1%></option>
            
                <option value="<%=ano2%>"><%=ano2.substring(2,5)%>/<%= parseInt(ano2.substring(2,5)) + 1%></option> 
                
                <option value="<%=ano1%>"><%=ano1.substring(2,5)%>/<%= parseInt(ano1.substring(2,5)) + 1%></option> 
                
            
        </select>
        <select id="selectPlanCalendario" onchange="cambiarPlanCalendario()">
            <option value="General" title="General">General</option>
            <% for(let i=0; i < planEstudios.length; i++) { 
                if (planEstudios[i].nombre !== null){ %>
                    <option value="<%=planEstudios[i].codigo%>" title="<%=planEstudios[i].nombreCompleto%> (<%=planEstudios[i].codigo%>)"><%=planEstudios[i].nombre%></option> 
                <%}else {%>
                    <option value="<%=planEstudios[i].codigo%>" title="<%=planEstudios[i].nombreCompleto%> (<%=planEstudios[i].codigo%>)"><%=planEstudios[i].codigo%></option> 
                <%}
            }%>
        </select>
    <% }%>

    <div class="tab">
        <button id='AbrirCerrar' class="tablinks" onclick="cambiarSubmenu(event, 'AbrirCerrar')">Abrir/Cerrar</button>
        <button id='Roles' class="tablinks" onclick="cambiarSubmenu(event, 'Roles')">Roles</button>
        <button id='Calendario' class="tablinks" onclick="cambiarSubmenu(event, 'Calendario')">Calendario</button>
        <button id='Grupos' class="tablinks" onclick="cambiarSubmenu(event, 'Grupos')">Grupos</button>
        <button id='Acronimos' class="tablinks" onclick="cambiarSubmenu(event, 'Acronimos')">Acrónimos</button>
    </div>

    <% if (locals.planID) { %>
        <input id='plan' type="hidden" value="<%=planID%>">
    <%} else {%>
        <input id='plan' type="hidden">
    <%}%>
    <% if (locals.submenu) { %>
        <input id='submenu' type="hidden" value="<%=submenu%>">
    <%} else {%>
    <input id='submenu' type="hidden">
    <%}%>
</div>
<script>
let selectPlanValue;
function cambiarSubmenu(evt, submenu) {
let elementPlan = document.getElementById("selectPlan")
let pAcronimo = 'GITST';
if (elementPlan){
    pAcronimo = document.getElementById("selectPlan").value
}else if (document.getElementById("plan").value){
    pAcronimo = document.getElementById("plan").value
}
if(submenu === 'AbrirCerrar'){
    let url = "<%=contextPath%>/AbrirCerrar"
    window.location.replace(url);
}

if (submenu === 'Grupos'){
let url = "<%=contextPath%>/gestionGrupos/getGrupos?planID="+pAcronimo
window.location.replace(url);
} 
if (submenu === 'Roles'){
let url = "<%=contextPath%>/gestionRoles"
window.location.replace(url);
}

if (submenu === 'Acronimos'){
let url = "<%=contextPath%>/gestion/acronimos"
window.location.replace(url);
}
if (submenu === 'Calendario'){
let url = "<%=contextPath%>/gestion/calendario"
window.location.replace(url);
}

}
function cambiarPD(){
let pAcronimo = document.getElementById("selectPlan").value;
let search = parseQueryString();
delete search.pdID;
search.planID = pAcronimo;
let url = parseStringQuery(search);
window.location.replace(url);

}



document.getElementsByTagName('body')[0].onload = actualizarSelectyBarra();
function actualizarSelectyBarra() {
selectPlanValue = document.getElementById('plan').value
if(!selectPlanValue) {
    selectPlanValue= "09TT"
}
let element2 = document.getElementById('selectPlan')
if (element2){
    document.getElementById('selectPlan').value = selectPlanValue;
}     
let submenu = document.getElementById('submenu').value
if(!submenu) {
    submenu= "AbrirCerrar"
}
document.getElementById(submenu).style.display = "block";
document.getElementById(submenu).className += " active";
}




function cambiarPlanCalendario(){
    let pAcronimo = document.getElementById("selectPlanCalendario").value;
    
    let search = parseQueryString();
    delete search.planID;
    if(pAcronimo !== "General"){

        search.planID = pAcronimo;
    }else{
        
    }
    
    let url = parseStringQuery(search);
    window.location.replace(url);
}

</script>
    
</body>
